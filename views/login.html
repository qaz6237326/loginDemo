<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="/lib/vue.js"></script>
    <script src="/lib/axios.min.js"></script>
</head>
<body>

<form action="http://127.0.0.1:8888/loginApi" method="post">
    First Name: <input type="text" name="first_name">
    <br>
    LastName:<input type="text" name="last_name">
    <input type="submit" value="Submit">
</form>

<div id="main">
    <p>
        用户名：<input type="text" v-model="obj.name">
    </p>
    <p>
        密码：<input type="password" v-model="obj.password">
    </p>
    <p>
        <button type="button" @click="login()">登录</button>
    </p>
    <ul>
        <li v-for="item in userInfo">
            <p>ID:{{item.id}}</p>
            <p>姓名：{{item.name}}</p>
            <p>年龄：{{item.age}}</p>
        </li>
    </ul>

    <p>
        <button @click="getToken()">获取token</button>
        <button @click="verToken()">验证token</button>
    </p>

</div>

<script>

    var vm = new Vue({
        el: '#main',
        data: {
            obj: {
                name: '',
                password: ''
            },
            userInfo: {}
        },
        methods: {
            login () {
                let _this = this
                console.log(this.obj)
                axios.post('/loginApi', this.obj)
                    .then((res) => {
                        if (res.data.result) {
                            _this.userInfo = res.data.data;
                            axios.defaults.headers.common['Authorization'] = res.data.token
                        } else {
                        }
                        console.log(res.data)
                    })
            },
            getToken () {
                let _this = this;
                axios.post('/current', this.obj)
                    .then((res) => {
                        console.log(res)
                        if (res.data.result) {
                            _this.userInfo = res.data.data;
                            axios.defaults.headers.common['Authorization'] = res.data.token
                        } else {
                        }
                    })
            },
            verToken () {
                let _this = this;
                axios.get('/ver')
                    .then((res) => {
                        console.log(res)
                        if (res.data.result) {

                        } else {
                        }
                    })
            }
        }
    })

    console.log(vm)

</script>

</body>
</html>